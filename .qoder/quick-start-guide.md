# Obsidian å›¾ç‰‡åŠ©æ‰‹æ’ä»¶ - å¿«é€Ÿä½¿ç”¨æŒ‡å—

## åŠŸèƒ½æ¦‚è¿°

æ•´åˆåçš„æ’ä»¶æ”¯æŒä¸‰ç§å›¾ç‰‡å¤„ç†æ¨¡å¼,å¯åœ¨è®¾ç½®ä¸­åˆ‡æ¢:

### 1. æœ¬åœ°æ¨¡å¼ (Local Mode) - é»˜è®¤
- **åŠŸèƒ½**: å®Œæ•´çš„å›¾ç‰‡å¤„ç†èƒ½åŠ›
- **é€‚ç”¨**: ç¦»çº¿å·¥ä½œã€éœ€è¦å®Œå…¨æ§åˆ¶å›¾ç‰‡
- **å¤„ç†æµç¨‹**:
  1. å›¾ç‰‡æ ¼å¼è½¬æ¢(JPEG/PNG/WebP/AVIF)
  2. å°ºå¯¸è°ƒæ•´å’Œå‹ç¼©
  3. ä¿å­˜åˆ°æœ¬åœ° vault
  4. æ’å…¥å¸¦å°ºå¯¸æ ‡è®°çš„é“¾æ¥
  5. æ¸²æŸ“å›¾ç‰‡é¢˜æ³¨

### 2. å›¾åºŠæ¨¡å¼ (Cloud Mode)
- **åŠŸèƒ½**: ä¸Šä¼ å›¾ç‰‡åˆ°å›¾åºŠæœåŠ¡
- **é€‚ç”¨**: åœ¨çº¿åˆ†äº«ã€å‡å°‘æœ¬åœ°å­˜å‚¨
- **å¤„ç†æµç¨‹**:
  1. ç›´æ¥ä¸Šä¼ åŸå›¾åˆ° PicGo/PicList
  2. è·å–å›¾åºŠ URL
  3. æ’å…¥å¸¦å°ºå¯¸æ ‡è®°çš„é“¾æ¥
  4. å¯é€‰æ‹©æ˜¯å¦æ¸²æŸ“é¢˜æ³¨

### 3. å…³é—­æ¨¡å¼ (Disabled Mode)
- **åŠŸèƒ½**: ä¸è¿›è¡Œä»»ä½•è‡ªåŠ¨å¤„ç†
- **é€‚ç”¨**: ä¸´æ—¶ç¦ç”¨æ’ä»¶åŠŸèƒ½
- **è¡Œä¸º**: å®Œå…¨ä½¿ç”¨ Obsidian é»˜è®¤è¡Œä¸º

## å›¾åºŠæ¨¡å¼é…ç½®

### å‰ç½®è¦æ±‚
1. å®‰è£…å¹¶è¿è¡Œ PicGo æˆ– PicList åº”ç”¨
2. åœ¨ PicGo/PicList ä¸­é…ç½®å¥½å›¾åºŠ(å¦‚ä¸ƒç‰›äº‘ã€è…¾è®¯äº‘COSã€é˜¿é‡Œäº‘OSSç­‰)
3. å¯åŠ¨ PicGo/PicList çš„æœåŠ¡å™¨(é»˜è®¤ç«¯å£ 36677)

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|--------|------|
| ä¸Šä¼ å™¨ç±»å‹ | PicGo | é€‰æ‹© PicGo æˆ– PicGo-Core |
| PicGo æœåŠ¡å™¨åœ°å€ | http://127.0.0.1:36677/upload | PicGo ä¸Šä¼ æ¥å£åœ°å€ |
| PicList åˆ é™¤æœåŠ¡å™¨åœ°å€ | http://127.0.0.1:36677/delete | PicList åˆ é™¤æ¥å£åœ°å€ |
| è¿œç¨‹æœåŠ¡å™¨æ¨¡å¼ | å…³é—­ | ç§»åŠ¨ç«¯å¿…é¡»å¼€å¯ |
| å›¾ç‰‡å®½åº¦ | æœªè®¾ç½® | é“¾æ¥ä¸­æ˜¾ç¤ºçš„å®½åº¦(åƒç´ ) |
| å›¾ç‰‡é«˜åº¦ | æœªè®¾ç½® | é“¾æ¥ä¸­æ˜¾ç¤ºçš„é«˜åº¦(åƒç´ ) |
| ä¸Šä¼ ååˆ é™¤æœ¬åœ°æ–‡ä»¶ | å…³é—­ | ä¸Šä¼ æˆåŠŸååˆ é™¤æœ¬åœ°ä¸´æ—¶æ–‡ä»¶ |

### å°ºå¯¸æ ‡è®°é…ç½®ç¤ºä¾‹

**ç¤ºä¾‹ 1: ä»…è®¾ç½®å®½åº¦ä¸º 600**
- é…ç½®: `imageSizeWidth = 600`, `imageSizeHeight = æœªè®¾ç½®`
- ç”Ÿæˆé“¾æ¥: `![ |600x](https://example.com/image.jpg)`

**ç¤ºä¾‹ 2: è®¾ç½®å®½é«˜ä¸º 800x600**
- é…ç½®: `imageSizeWidth = 800`, `imageSizeHeight = 600`
- ç”Ÿæˆé“¾æ¥: `![ |800x600](https://example.com/image.jpg)`

**ç¤ºä¾‹ 3: ä¸è®¾ç½®å°ºå¯¸**
- é…ç½®: ä¸¤è€…éƒ½æœªè®¾ç½®
- ç”Ÿæˆé“¾æ¥: `![ ](https://example.com/image.jpg)`

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: ä¸ªäººç¬”è®°(æœ¬åœ°æ¨¡å¼)
é€‚åˆä¸éœ€è¦åˆ†äº«çš„ä¸ªäººç¬”è®°,å®Œå…¨æ§åˆ¶å›¾ç‰‡è´¨é‡å’Œå­˜å‚¨ã€‚

**æ¨èé…ç½®**:
- ç²˜è´´æ¨¡å¼: `local`
- è¾“å‡ºæ ¼å¼: `WEBP` (è¾ƒå°ä½“ç§¯)
- è´¨é‡: `85`
- å¯ç”¨é¢˜æ³¨: `æ˜¯`

### åœºæ™¯ 2: åšå®¢æ–‡ç« (å›¾åºŠæ¨¡å¼)
é€‚åˆéœ€è¦åœ¨çº¿åˆ†äº«çš„åšå®¢æ–‡ç« ,å‡å°‘æœ¬åœ°å­˜å‚¨å ç”¨ã€‚

**æ¨èé…ç½®**:
- ç²˜è´´æ¨¡å¼: `cloud`
- ä¸Šä¼ å™¨: `PicGo`
- å›¾ç‰‡å®½åº¦: `800` (é€‚åˆåšå®¢é˜…è¯»)
- å¯ç”¨é¢˜æ³¨: `å¦` (alt ä¸ºç©ºæ ¼ä¼šéšè—é¢˜æ³¨)

### åœºæ™¯ 3: ä¸´æ—¶è‰ç¨¿(å…³é—­æ¨¡å¼)
å¿«é€Ÿè®°å½•ä¸´æ—¶æƒ³æ³•,ä¸éœ€è¦ä»»ä½•å›¾ç‰‡å¤„ç†ã€‚

**æ¨èé…ç½®**:
- ç²˜è´´æ¨¡å¼: `disabled`

## é¢˜æ³¨åŠŸèƒ½è¯´æ˜

### é¢˜æ³¨ç‹¬ç«‹æ€§
é¢˜æ³¨åŠŸèƒ½ä¸ç²˜è´´æ¨¡å¼**å®Œå…¨ç‹¬ç«‹**:
- åœ¨**ä»»ä½•æ¨¡å¼**ä¸‹éƒ½å¯ä»¥å¯ç”¨æˆ–ç¦ç”¨é¢˜æ³¨
- é¢˜æ³¨åŸºäºå›¾ç‰‡çš„ `alt` å±æ€§æ¸²æŸ“
- ä¸å—å›¾ç‰‡æ¥æº(æœ¬åœ°/å›¾åºŠ)å½±å“

### å›¾åºŠæ¨¡å¼ä¸‹çš„é¢˜æ³¨
- å›¾åºŠæ¨¡å¼ç”Ÿæˆçš„é“¾æ¥ alt ä¸ºç©ºæ ¼: `![ ](url)`
- ç©ºæ ¼ alt ä¼šè¢« CSS è‡ªç„¶éšè—,ä¸æ˜¾ç¤ºé¢˜æ³¨
- å¦‚æœè®¾ç½®äº†å°ºå¯¸: `![ |800x600](url)`,å°ºå¯¸å‚æ•°ä¼šæ˜¾ç¤º

### æœ¬åœ°æ¨¡å¼ä¸‹çš„é¢˜æ³¨
- ä½¿ç”¨æ–‡ä»¶åæˆ–è‡ªå®šä¹‰æ–‡æœ¬ä½œä¸º alt
- é¢˜æ³¨æ­£å¸¸æ¸²æŸ“æ˜¾ç¤º

## å¸¸è§é—®é¢˜

### Q1: å›¾åºŠæ¨¡å¼ä¸Šä¼ å¤±è´¥?
**æ£€æŸ¥æ¸…å•**:
1. PicGo/PicList æ˜¯å¦æ­£åœ¨è¿è¡Œ?
2. æœåŠ¡å™¨åœ°å€æ˜¯å¦æ­£ç¡®?(é»˜è®¤ http://127.0.0.1:36677/upload)
3. å›¾åºŠé…ç½®æ˜¯å¦æ­£ç¡®?(åœ¨ PicGo/PicList ä¸­æµ‹è¯•ä¸Šä¼ )
4. ç§»åŠ¨ç«¯æ˜¯å¦å¼€å¯äº†è¿œç¨‹æœåŠ¡å™¨æ¨¡å¼?

### Q2: å°ºå¯¸æ ‡è®°ä¸ç”Ÿæ•ˆ?
**å¯èƒ½åŸå› **:
1. Obsidian ç‰ˆæœ¬å¤ªæ—§,ä¸æ”¯æŒ `|WxH` è¯­æ³•
2. åœ¨å®æ—¶é¢„è§ˆæ¨¡å¼ä¸‹å¯èƒ½éœ€è¦åˆ‡æ¢åˆ°é˜…è¯»æ¨¡å¼æŸ¥çœ‹æ•ˆæœ
3. æ£€æŸ¥é“¾æ¥æ ¼å¼æ˜¯å¦æ­£ç¡®: `![ |800x600](url)`

### Q3: é¢˜æ³¨ä¸æ˜¾ç¤º?
**æ£€æŸ¥æ¸…å•**:
1. è®¾ç½®ä¸­æ˜¯å¦å¯ç”¨äº† `enableImageCaptions`?
2. æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨æ’é™¤åˆ—è¡¨ä¸­(`skipCaptionExtensions`)?
3. alt æ–‡æœ¬æ˜¯å¦ä¸ºç©ºç™½?(å›¾åºŠæ¨¡å¼é»˜è®¤ç©ºæ ¼ä¼šéšè—é¢˜æ³¨)

### Q4: æ¨¡å¼åˆ‡æ¢åä¸ç”Ÿæ•ˆ?
**è§£å†³æ–¹æ³•**:
- é‡æ–°æ‰“å¼€å½“å‰ç¬”è®°æˆ–é‡å¯ Obsidian
- æ£€æŸ¥è®¾ç½®æ˜¯å¦å·²ä¿å­˜

## æŠ€æœ¯ç»†èŠ‚

### å›¾åºŠä¸Šä¼ æµç¨‹
```
1. æ£€æµ‹åˆ°ç²˜è´´/æ‹–æ”¾å›¾ç‰‡
   â†“
2. åˆ¤æ–­ç²˜è´´æ¨¡å¼ = cloud
   â†“
3. æ’å…¥ä¸Šä¼ å ä½ç¬¦
   â†“
4. åˆ›å»ºä¸´æ—¶æ–‡ä»¶
   â†“
5. è°ƒç”¨ UploaderManager.upload()
   â†“
6. PicGo/PicList å¤„ç†ä¸Šä¼ 
   â†“
7. åˆ é™¤ä¸´æ—¶æ–‡ä»¶
   â†“
8. ç”Ÿæˆå›¾åºŠé“¾æ¥(å«å°ºå¯¸æ ‡è®°)
   â†“
9. æ›¿æ¢å ä½ç¬¦
   â†“
10. åˆ·æ–°é¢˜æ³¨
```

### é“¾æ¥æ ¼å¼å¯¹æ¯”

| æ¥æº | æ— å°ºå¯¸ | æœ‰å°ºå¯¸ |
|------|--------|--------|
| æœ¬åœ°æ¨¡å¼ | `![[image.jpg]]` | `![[image.jpg\|800x600]]` |
| å›¾åºŠæ¨¡å¼ | `![ ](https://cdn.com/img.jpg)` | `![ \|800x600](https://cdn.com/img.jpg)` |

### ä»£ç æ¶æ„
```
main.ts (å…¥å£)
  â”œâ”€ dropPasteRegisterEvents() - äº‹ä»¶æ³¨å†Œ
  â”‚    â”œâ”€ æ¨¡å¼åˆ¤æ–­
  â”‚    â”œâ”€ local â†’ handleDrop/handlePaste (åŸæœ‰é€»è¾‘)
  â”‚    â”œâ”€ cloud â†’ handleDropCloud/handlePasteCloud (æ–°å¢)
  â”‚    â””â”€ disabled â†’ ç›´æ¥è¿”å›
  â”‚
  â”œâ”€ handleDropCloud() - å›¾åºŠæ‹–æ”¾å¤„ç†
  â”‚    â””â”€ UploaderManager.upload()
  â”‚         â””â”€ PicGoUploader/PicGoCoreUploader
  â”‚              â””â”€ CloudLinkFormatter.formatCloudLink()
  â”‚
  â””â”€ ImageCaptionManager (ç‹¬ç«‹,ä¸å—æ¨¡å¼å½±å“)
```

## å¼€å‘è€…æ³¨æ„äº‹é¡¹

### éœ€è¦å®ç°çš„ UI
åœ¨ `ImageConverterSettings.ts` ä¸­æ·»åŠ è®¾ç½® UI:
```typescript
// ç²˜è´´å¤„ç†æ¨¡å¼é€‰æ‹©
new Setting(containerEl)
    .setName("ç²˜è´´å¤„ç†æ¨¡å¼")
    .addDropdown(dropdown => {
        dropdown
            .addOption("local", "æœ¬åœ°æ¨¡å¼")
            .addOption("cloud", "å›¾åºŠæ¨¡å¼")
            .addOption("disabled", "å…³é—­")
            .setValue(this.plugin.settings.pasteHandlingMode)
            .onChange(async (value) => {
                this.plugin.settings.pasteHandlingMode = value;
                await this.plugin.saveSettings();
            });
    });

// å›¾åºŠé…ç½®åŒºåŸŸ(ä»…åœ¨ cloud æ¨¡å¼æ˜¾ç¤º)
if (this.plugin.settings.pasteHandlingMode === 'cloud') {
    // æ·»åŠ å›¾åºŠé…ç½® UI...
}
```

### æ„å»ºæ­¥éª¤
```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. æ„å»ºæ’ä»¶
npm run build

# 3. å¤åˆ¶åˆ° Obsidian æ’ä»¶ç›®å½•
# å°† main.js, manifest.json, styles.css å¤åˆ¶åˆ°:
# .obsidian/plugins/obsidian-image-assistant/
```

## æ€»ç»“

æ•´åˆåçš„æ’ä»¶å®ç°äº†:
- âœ… çµæ´»çš„æ¨¡å¼åˆ‡æ¢
- âœ… å®Œæ•´çš„æœ¬åœ°å¤„ç†èƒ½åŠ›
- âœ… æ— ç¼çš„å›¾åºŠé›†æˆ
- âœ… ç‹¬ç«‹çš„é¢˜æ³¨åŠŸèƒ½
- âœ… ç»Ÿä¸€çš„å°ºå¯¸æ ‡è®°æ”¯æŒ

äº«å—ä½ çš„æ–°å›¾ç‰‡åŠ©æ‰‹å§! ğŸ‰
